{
  "comments": [
    {
      "unresolved": true,
      "key": {
        "uuid": "d112418b_37cc3abf",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 11
      },
      "lineNbr": 0,
      "author": {
        "id": 1000062
      },
      "writtenOn": "2023-12-14T18:50:49Z",
      "side": 1,
      "message": "Test: Manual: All operations are in the work profile. Begin without Tor Browser installed. Disconnect and reconnect Orbot. Install Tor Browser. Try to use Tor Browser. It should connect successfully.\n\nThe above test is failing. If I disconnect and reconnect Orbot, it starts working... so I think this change isn\u0027t working.\n\nLet me know I\u0027m misunderstanding this change.",
      "revId": "f24e52164c24882e1d2e5a4f7036e8b126e29102",
      "serverId": "35266860-6252-469c-a67d-185064479fc0"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "0b4038b7_d100bcf4",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 11
      },
      "lineNbr": 0,
      "author": {
        "id": 1000002
      },
      "writtenOn": "2023-12-14T18:54:41Z",
      "side": 1,
      "message": "Can you verify what\u0027s in the vpn lockdown allowlist when this is being executed? If TOR browser is missing, why is it so?",
      "parentUuid": "d112418b_37cc3abf",
      "revId": "f24e52164c24882e1d2e5a4f7036e8b126e29102",
      "serverId": "35266860-6252-469c-a67d-185064479fc0"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "a2cf012b_4fd6723a",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 11
      },
      "lineNbr": 0,
      "author": {
        "id": 1000002
      },
      "writtenOn": "2023-12-14T18:56:07Z",
      "side": 1,
      "message": "If this change triggers, setVpnForcedLocked, in the previous change, it should be always adding TOR browser",
      "parentUuid": "0b4038b7_d100bcf4",
      "revId": "f24e52164c24882e1d2e5a4f7036e8b126e29102",
      "serverId": "35266860-6252-469c-a67d-185064479fc0"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "e699bfa3_f654ca8b",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 11
      },
      "lineNbr": 0,
      "author": {
        "id": 1000062
      },
      "writtenOn": "2023-12-14T19:05:12Z",
      "side": 1,
      "message": "Is there a command I can use to check that, or do I have to debug? If you\u0027re thinking of this:\n```\nadb shell settings --user 10 list secure | grep always`\nalways_on_vpn_lockdown_whitelist\u003d\n```\n^ It\u0027s empty all the time, and I think that\u0027s normal because we\u0027re not changing it.",
      "parentUuid": "a2cf012b_4fd6723a",
      "revId": "f24e52164c24882e1d2e5a4f7036e8b126e29102",
      "serverId": "35266860-6252-469c-a67d-185064479fc0"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "d1980140_a37cba3d",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 11
      },
      "lineNbr": 0,
      "author": {
        "id": 1000062
      },
      "writtenOn": "2023-12-14T21:00:04Z",
      "side": 1,
      "message": "The change is triggered. setVpnForcedLocked is reached. The package is detected as present, matching, and its uid is successfully retrieved. But ultimately it doesn\u0027t end up being reflected in `ip rule` until disconnecting and reconnecting Orbot. This will need more troubleshooting/debugging.",
      "parentUuid": "e699bfa3_f654ca8b",
      "revId": "f24e52164c24882e1d2e5a4f7036e8b126e29102",
      "serverId": "35266860-6252-469c-a67d-185064479fc0"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "9edd3e10_7aa6c56a",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 11
      },
      "lineNbr": 0,
      "author": {
        "id": 1000062
      },
      "writtenOn": "2023-12-14T21:00:29Z",
      "side": 1,
      "message": "It also seems to be a race somehow, because if debugging with breakpoints, the issue does not occur.",
      "parentUuid": "d1980140_a37cba3d",
      "revId": "f24e52164c24882e1d2e5a4f7036e8b126e29102",
      "serverId": "35266860-6252-469c-a67d-185064479fc0"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "bbf2d0de_95e80c9b",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 11
      },
      "lineNbr": 0,
      "author": {
        "id": 1000062
      },
      "writtenOn": "2023-12-14T22:07:34Z",
      "side": 1,
      "message": "When Tor Browser is working:\n`HAPPY_BOX_MATCH RESTRICTED_MATCH`\n\nWhen it is not working:\n`HAPPY_BOX_MATCH RESTRICTED_MATCH IIF_MATCH ##`\n\n1. Connect Orbot.\n2. Install Tor Browser.\n3. Get its work profile uid via `adb shell pm list packages -U | grep -F org.torproject.torbrowser`\n4. `adb shell dumpsys connectivity trafficcontroller | grep $uid`\n5. You\u0027ll see the \"not working\" result unless you\u0027re lucky, and it won\u0027t work.\n6. Disconnect and reconnect Orbot.\n7. Repeat step 4 and you\u0027ll see the \"working\" result, and it will work.\n\nConnectivity\u0027s PermissionMonitor adjusts IIF_MATCH with updateVpnUid and some other methods, either in response to package changes or called from ConnectivityService. It doesn\u0027t look like the package change response is the conflict, oddly, but I could be wrong.",
      "parentUuid": "9edd3e10_7aa6c56a",
      "revId": "f24e52164c24882e1d2e5a4f7036e8b126e29102",
      "serverId": "35266860-6252-469c-a67d-185064479fc0"
    }
  ]
}